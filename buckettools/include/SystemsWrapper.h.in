
#ifndef __SYSTEMS_WRAPPER_H
#define __SYSTEMS_WRAPPER_H

#include "Bucket.h"
#include <dolfin.h>

${include_ufcs}

namespace buckettools
{
  
  // A wrapper to fetch the FunctionSpace from a set of namespaces
  FuncionSpace_ptr fetch_functionspace(std::string name, Mesh_ptr mesh)
  {
    
    switch(name)
    {

${case_functionspace}

      default:
        dolfin::error("Unknown namespace for functionspace.");
    }

    return sysspace;

  }

  // A wrapper to fetch Form_0 from a set of namespaces
  // This is used for Picard iteration loops to define the bilinear form
  // This is used in SNES iterations to define the Jacobian
  Form_ptr fetch_form_0(std::string name, FunctionSpace_ptr fs)
  {

    switch(name)
    {

${case_form_0}

      default:
        dolfin::error("Unknown namespace for form_0.");
    }

    return form_0;

  }

  // A wrapper to fetch Form_1 from a set of namespaces
  // This is used for Picard iteration loops to define the linear form
  // This is used in SNES iterations to define the residual vector
  Form_ptr fetch_form_1(std::string name, FunctionSpace_ptr fs)
  {

    switch(name)
    {

${case_form_1}

      default:
        dolfin::error("Unknown namespace for form_1.");
    }

    return form_1;

  }

  // A wrapper to fetch Form_2 from a set of namespaces
  // This is used for Picard iteration loops to define the residual functional
  // It is not used in SNES iterations so may not be well defined
  Form_ptr fetch_form_2(std::string name, FunctionSpace_ptr fs)
  {

    switch(name)
    {

${case_form_2}

      default:
        dolfin::error("Unknown namespace for form_2.");
    }

    return form_2;

  }

}

#endif
